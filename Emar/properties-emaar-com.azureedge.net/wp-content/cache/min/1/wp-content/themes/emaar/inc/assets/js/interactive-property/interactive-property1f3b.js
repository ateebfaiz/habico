$(document).ready(function(){$("#interactive_prop_form").submit(function(e){e.preventDefault();filterByProperty()});function multiDimensionalUnique(arr){var uniques=[];var itemsFound={};for(var i=0,l=arr.length;i<l;i++){var stringified=JSON.stringify(arr[i]);if(itemsFound[stringified]){continue}
uniques.push(arr[i]);itemsFound[stringified]=!0}
return uniques}
function filterByProperty(){var filter={};var formEl=document.forms.interactive_prop_form;var formData=new FormData(formEl);var minarea=formData.get('min-area');var maxarea=formData.get('max-area');var minprice=formData.get('min-price');var maxprice=formData.get('max-price');var beds=formData.getAll('bed[]');var arr=IMPropertyMainObj;if(minarea)
var arr=filterPropertyByComparison(arr,"area",minarea,"<");if(maxarea)
var arr=filterPropertyByComparison(arr,"area",maxarea,">");if(minprice)
var arr=filterPropertyByComparison(arr,"price",minprice,"<");if(maxprice)
var arr=filterPropertyByComparison(arr,"price",maxprice,">");const bedIndex=beds.indexOf('5+');if(bedIndex>-1){beds.splice(bedIndex,1);beds=beds.concat(['5','6','7','8','9','10'])}
if(beds.length){var allBedObj=[];for(var b=0;b<beds.length;b++){var somethingelse=filterPropertyByComparison(arr,"bed",beds[b],"=");somethingelse=somethingelse[0];if(typeof somethingelse!='undefined'){allBedObj.push(somethingelse)}}
if(minarea||maxarea||minprice||maxprice){var arr1=arr.flat();var arr2=allBedObj;var someFinal=[];$.each(arr1,function(old_index,old_obj){var old_id=old_obj.map_id;var found=!1;$.each(arr2,function(new_index,new_obj){if(new_obj.map_id==old_id){found=!0;someFinal.push(new_obj)}});if(!found){}});arr=someFinal}else{arr=allBedObj;arr=multiDimensionalUnique(arr.flat())}}
iteratePolygon(arr)}
function iteratePolygon(filtered){if(typeof filtered=='undefined'||!filtered)
return;var html='';$.each(filtered,function(key,value){html+='<area title="'+value.bed+' BHK'+'" data-state="'+value.bed+'_BHK" href="#" coords="'+value.coordinate+'" data-floor="'+value.floor+'" data-area="'+value.area+'" data-area-measure="'+value.area_measure+'" data-bed="'+value.bed+'" data-price="'+value.price+'" shape="poly" data-floor-plan="'+value.floor_plan+'" data-mapster-key="'+value.map_id+'" >'});$('#prop_image_map area').mapster('deselect');$('#prop_image_map').html(html);$('#themap').mapster({clickNavigate:!1,isSelectable:!1,highlight:!1,});$.each(filtered,function(key,value){$('#prop_image_map area[data-state="'+value.bed+'_BHK"]').mapster('set',!0,clickedOptions)});window.filteredIMProp=filtered}
function propModalOpen(mapsterID){$("html, body").animate({scrollTop:0},100);$.each(filteredIMProp,function(key,val){filteredIMProp[key].map_id=key});if(filteredIMProp.length>1)
var unitFilter=filteredIMProp.filter(function(unit){return unit.map_id==mapsterID});else unitFilter=filteredIMProp;if(typeof unitFilter[0]!='undefined')
unitFilter=unitFilter[0];var bedRooms=unitFilter.floor;if(bedRooms>1){bedRooms=unitFilter.floor+' bedrooms'}else{bedRooms=unitFilter.floor+' bedroom'}
var floorPlan='';if(unitFilter.floor_plan.url){floorPlan='<iframe width="100%" height="960px" src="'+unitFilter.floor_plan.url+'" type="application/pdf" ></iframe>'}else{floorPlan=''}
var innerSectionDtl='<div class="row">'+'<div class="col-md-3 interactive-block-left">'+'<button type="button" class="close" data-dismiss="modal" aria-label="Close">'+'<i class="far fa-arrow-left" aria-hidden="true"></i> Back'+'</button>'+'<hr>'+'<h3>'+bedRooms+'<br>'+'Apartment</h3>'+'<ul class="prop-list">'+'<li class="building-floor">'+'<label><img src="'+templateUrl+'/inc/assets/images/IPD-floor.svg" /> Building Floor</label>'+'<span>'+unitFilter.floor+'</span>'+'</li>'+'<li class="prop-area">'+'<label><img src="'+templateUrl+'/inc/assets/images/IPD-Shape.svg" /> Area from</label>'+'<span>'+numberWithCommas(unitFilter.area)+' '+unitFilter.area_measure+'</span>'+'</li>'+'<li class="prop-price-from">'+'<label><i class="far fa-tag"></i> Prices from</label>'+'<span>'+currency_text+' '+numberWithCommas(unitFilter.price)+'</span>'+'</li>'+'</ul>'+'<a href="javascript:void(0);" class="btn btn-ghost prop-reg-btn w-100 mb-4" data-toggle="modal" data-target="#registerModal">Register Your Interest</a>'+'<a href="'+unitFilter.book_online_url+'" class="btn btn-blue w-100" target="_blank">Book Now</a>'+'</div>'+'<div class="col-md-9 interactive-block-right">'+'<h3>FLOOR PLAN</h3>'+'<hr>'+floorPlan+'</div>'+'</div>';$('#prop_detail_block').html('<div class="col-12 prop-inner-dtl">'+innerSectionDtl+'</div>');$('.closePopEle').trigger('click');$('#prop_detail_modal').modal('show');$(".cookie-disclaimer").not(':hidden').parent().find('.interactive-wrapper .modal-property-detail.show').css('margin-top','100px');$(".cookie-disclaimer:hidden").parent().find('.interactive-wrapper .modal-property-detail.show').css('margin-top','72px')}
$('#interactive_prop_form .bedroom-selection .bedroom-options.select-sec-options ul li input[name="bed[]"]').on('click',function(){var bedrooms=[];var bedroomsText="";$.each($('input[name="bed[]"]:checked'),function(){single_string=$(this).attr('id').match(/\d+/);if(single_string=="5")
single_string=single_string+'+';bedrooms.push(single_string)});bedroomsText=bedrooms.join(", ");if(bedroomsText=='1'){bedroomsText=bedrooms+' Bedroom'}else{bedroomsText=bedrooms+' Bedrooms'}
bedroomsText=bedroomsText.replace(/,/g,", ");if($('input[name="bed[]"]:checked').length>0){$('.bedroom-selection').find('span.search-val').addClass('selected-val').text(bedroomsText)}else{$('.bedroom-selection').find('span.search-val').removeClass('selected-val').text('Any')}});$('.bedroom-options.select-sec-options .apply-btn').on('click',function(){$(this).parents('.bedroom-selection').find('.search-fld').trigger('click')});$('.clear-selection').click(function(){$(this).parents('.bedroom-options.select-sec-options').find('ul li input').each(function(){$(this).prop('checked',!1)});$('.bedroom-selection').find('span.search-val').removeClass('selected-val').text('Any')});$('.area-options.select-sec-options .apply-btn').on('click',function(){$(this).parents('.area-selection').find('.search-fld').trigger('click');var minArea=$('#minArea').val();var maxArea=$('#maxArea').val();var areaText="";if(minArea&&maxArea){areaText=minArea+'-'+maxArea}else if(minArea&&!maxArea){areaText=minArea}else if(!minArea&&maxArea){areaText=maxArea}else{areaText="Any"}
$('.area-selection').find('span.search-val').addClass('selected-val').text(areaText)});$('.clear-selection').click(function(){$(this).parents('.area-options.select-sec-options').find('select').each(function(){$(this).prop('selectedIndex',0)});$('.area-selection').find('span.search-val').removeClass('selected-val').text('Any')});$('.price-options.select-sec-options .apply-btn').on('click',function(){$(this).parents('.price-range-selection').find('.search-fld').trigger('click');var minPrice=$('#minPrice').val();var maxPrice=$('#maxPrice').val();var priceText="";if(minPrice&&maxPrice){priceText=minPrice+'-'+maxPrice}else if(minPrice&&!maxPrice){priceText=minPrice}else if(!minPrice&&maxPrice){priceText=maxPrice}else{priceText="Any"}
$('.price-range-selection').find('span.search-val').addClass('selected-val').text(priceText)});$('.clear-selection').click(function(){$(this).parents('.price-options.select-sec-options').find('select').each(function(){$(this).prop('selectedIndex',0)});$('.price-range-selection').find('span.search-val').removeClass('selected-val').text('Any')});$('#themap').mapster({clickNavigate:!1,isSelectable:!1,highlight:!0,fill:!0,fillColor:'9B0000',fillOpacity:0.7,stroke:!1,});function compareRange(x,y,z){return x>=y&&x<=z}
clickedOptions={fill:!0,fillColor:'9B0000',fillOpacity:0.7,stroke:!1,};$(document).on('click','.prop-modal-open',function(e){propModalOpen($(this).attr('id'))});$(document).on('click','area',function(e){var xHtml="";var x=e.pageX;var y='';$("#prop_detail_modal").attr('mapsterKey',$(this).data('mapster-key'));var adminToolBarHeight=$('#wpadminbar').innerHeight();var menuHeaderHeight=$('.site-header').innerHeight();var headCookieHeight=$('.cookie-disclaimer').innerHeight();if((adminToolBarHeight!==undefined||adminToolBarHeight)&&(headCookieHeight!==undefined||headCookieHeight)&&menuHeaderHeight){y=e.pageY-(adminToolBarHeight+headCookieHeight+menuHeaderHeight)}else if((adminToolBarHeight!==undefined||adminToolBarHeight)&&menuHeaderHeight){y=e.pageY-(adminToolBarHeight+menuHeaderHeight)}else if((headCookieHeight!==undefined||headCookieHeight)&&menuHeaderHeight){y=e.pageY-(headCookieHeight+menuHeaderHeight)}else if(menuHeaderHeight){y=e.pageY-menuHeaderHeight}
xHtml+='<div id="popContentBox" style="z-index:999;" class="pop-content">'+'<a href="#" class="closePopEle"><i class="fa fa-remove"></i></a>'+'<ul class="pop-list">'+'<li><span class="popLabel">Floor</span> <span class="prop-data">'+$(this).data('floor')+'</span></li>'+'<li><span class="popLabel">Total Area</span> <span class="prop-data">'+numberWithCommas($(this).data('area'))+' '+$(this).data('area-measure')+'</span></li>'+'<li><span class="popLabel">Bedrooms</span> <span class="prop-data">'+$(this).data('bed')+'</span></li>'+'</ul>'+'<a class="btn btn-blue w-100 prop-modal-open" id="'+$(this).data('mapster-key')+'" data-mapster-key="'+$(this).data('mapster-key')+'">View Details</a>'+'</div>';var dynamicMapTPID='popEleId'+$(this).data('mapster-key');$('.interactiveInnerWrap').html('<a href="javascript:void(0);" id="'+dynamicMapTPID+'" style="position: absolute; left: '+x+'px; top: '+y+'px; display: block;"></a>');setTimeout(function(){$('#'+dynamicMapTPID).popover({container:'.interactiveInnerWrap',placement:'top',html:!0,content:xHtml});$('#'+dynamicMapTPID).trigger('click',!0)},200)
$('#'+dynamicMapTPID).click(function(e){e.stopPropagation()});$(document).click(function(e){if(($('.popover').has(e.target).length==0)||$(e.target).is('.close')){$('#'+dynamicMapTPID).popover('hide')}});$(document).on('click','.closePopEle',function(e){e.preventDefault();$('#'+dynamicMapTPID).popover('hide')})});$('.ip-top-block').hide();var resizing,body=$(body),win=$(window),diffW=win.width()-$('#themap').width(),lastw=win.innerWidth(),lasth=win.innerHeight();var resize=function(){var win=$(window),width=win.width(),height=win.height();if(resizing){return}
if(lastw!==width||lasth!==height){resizing=!0;$('#themap').mapster('resize',width-diffW,0,200);lastw=width;lasth=height;setTimeout(function(){resizing=!1;resize()},200)}else{}};$(window).bind('resize',resize);$(document).mouseup(function(e){var popEle=$(".popEle");if(!popEle.is(e.target)&&popEle.has(e.target).length===0){popEle.hide()}});$('.interactive-reg-btn').click(function(){$("#registerModal").addClass("interactive-ryi-modal")})});function numberWithCommas(x){return x.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")}
window.operators={'=':function(a,b){return parseInt(a)==parseInt(b)},'<':function(a,b){return parseInt(a)<=parseInt(b)},'>':function(a,b){return parseInt(a)>=parseInt(b)},};function filterPropertyByComparison(array,prop,value,operator){var filtered=[];for(var i=0;i<array.length;i++){var obj=array[i];for(var key in obj){if(typeof(obj[key]=="object")){var item=obj[key];if(key==prop&&item&&operators[operator](value,item)){filtered.push(obj)}}}}
return filtered}